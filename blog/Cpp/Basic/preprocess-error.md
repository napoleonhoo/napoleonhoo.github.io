# 预编译指令——\#error

使用protobuf时，protoc自动生成的pb.h中，有这样的一段代码：

```c
#include <google/protobuf/port_def.inc>
#if PROTOBUF_VERSION < 3007000
#error This file was generated by a newer version of protoc which is
#error incompatible with your Protocol Buffer headers. Please update
#error your headers.
#endif
#if 3007001 < PROTOBUF_MIN_PROTOC_VERSION
#error This file was generated by an older version of protoc which is
#error incompatible with your Protocol Buffer headers. Please
#error regenerate this file with a newer version of protoc.
#endif
```

其中，\#error引起了我的注意。经查，在[totn][https://www.techonthenet.com/c_language/directives/error.php]有这么一段话：

> In the C Programming Language, the \#error directive causes preprocessing to stop at the location where the directive is encountered. Information following the #error directive is output as a message prior to stopping preprocessing.

即：

> 在预编译的时候，\#error可以让编译过程停止报错，并将相应的message输出。（此处的message指的就是跟在\#error后面那句话。）

示例：

```cpp
#include <iostream>

#define VALUE 9

int main(int argc, char *argv[]) {
#if VALUE < 1
#error value is to small
#endif
#if VALUE > 100
#error value is to large
#endif
#if VALUE == 9
#error define error test success
#endif

  std::cout << "test end" << std::endl;

  return 0;
}
```

编译时，得到了如下的结果：

```
error_directive_test.cc:13:2: error: #error define error test success
   13 | #error define error test success
      |  ^~~~~
```



